<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Shop DonatSur - CHASTE DRAGON</title>

<style>
body{
  background:black;
  color:white;
  font-family:Poppins;
  padding:40px;
}

h1,h2,h3{color:gold;}

.varian-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(180px,1fr));
  gap:15px;
}

.varian-item{
  border:2px solid gold;
  padding:10px;
  text-align:center;
}

.varian-item img{
  width:100%;
  height:130px;
  object-fit:cover;
}

.qty-box{
  display:flex;
  justify-content:center;
  align-items:center;
  gap:10px;
  margin-top:5px;
}

button{
  cursor:pointer;
}
</style>
</head>

<body>

<h1>üç© SHOP DONATSUR</h1>
<h2>CHASTE DRAGON SQUAD</h2>

<hr style="border:1px solid gold;margin:30px 0;">

<h3>Pilih Paket</h3>
<select id="paket" onchange="resetSemua()" style="padding:10px;">
  <option value="3">Box Isi 3 (Diskon 5%)</option>
  <option value="6">Box Isi 6 (Diskon 10%)</option>
</select>

<br><br>

<h3>Pilih Donat</h3>
<div class="varian-grid" id="varianContainer"></div>

<br>

<h3>Promo Code</h3>
<input type="text" id="promoInput" placeholder="Kode Promo" style="padding:8px;">
<button onclick="hitungTotal()">Gunakan</button>

<h2>Total: <span id="totalHarga">Rp 0</span></h2>

<button onclick="pesanSekarang()" 
style="padding:15px 30px;background:gold;color:black;font-weight:bold;border:none;">
Pesan Sekarang
</button>

<script>
const hargaSatuan = 8000;
const phoneNumber = "628XXXXXXXXXX"; // GANTI NOMOR ADMIN

let stokVarian = {
"Coklat": {stok:10, image:"https://i.imgur.com/6X4KQ5b.jpg"},
"Regal Matcha": {stok:8, image:"https://i.imgur.com/8Km9tLL.jpg"},
"Tiramisu Biscoff": {stok:5, image:"https://i.imgur.com/U9WbG4F.jpg"},
"Keju": {stok:12, image:"https://i.imgur.com/W5kY6aJ.jpg"},
"Custard Milk": {stok:6, image:"https://i.imgur.com/yP4X5gT.jpg"},
"Sugar Dust": {stok:15, image:"https://i.imgur.com/V9kZx3H.jpg"},
"Buttery Glazed": {stok:7, image:"https://i.imgur.com/Bn6qT4E.jpg"},
"Triple Choco": {stok:4, image:"https://i.imgur.com/F3hY8Kq.jpg"},
"Double Choco": {stok:9, image:"https://i.imgur.com/J7lMn2R.jpg"}
};

const promoList = {
"DRAGON5":0.05,
"DONAT10":0.10
};

let cart = {};

function generateMenu(){
  const container = document.getElementById("varianContainer");
  container.innerHTML = "";

  for(let rasa in stokVarian){

    cart[rasa] = 0;

    const item = document.createElement("div");
    item.className = "varian-item";

    item.innerHTML = `
      <img src="${stokVarian[rasa].image}">
      <p><strong>${rasa}</strong></p>
      <p style="color:gold;">Rp ${hargaSatuan.toLocaleString("id-ID")}</p>
      <p>Stok: ${stokVarian[rasa].stok}</p>
      <div class="qty-box">
        <button onclick="kurang('${rasa}')">-</button>
        <span id="qty-${rasa}">0</span>
        <button onclick="tambah('${rasa}')">+</button>
      </div>
    `;

    container.appendChild(item);
  }

  hitungTotal();
}

function totalItemDipilih(){
  return Object.values(cart).reduce((a,b)=>a+b,0);
}

function tambah(rasa){
  const paket = parseInt(document.getElementById("paket").value);

  if(totalItemDipilih() >= paket){
    alert("Jumlah donat sudah sesuai paket!");
    return;
  }

  if(cart[rasa] >= stokVarian[rasa].stok){
    alert("Stok tidak cukup!");
    return;
  }

  cart[rasa]++;
  document.getElementById("qty-"+rasa).innerText = cart[rasa];
  hitungTotal();
}

function kurang(rasa){
  if(cart[rasa] > 0){
    cart[rasa]--;
    document.getElementById("qty-"+rasa).innerText = cart[rasa];
    hitungTotal();
  }
}

function hitungTotal(){
  const paket = parseInt(document.getElementById("paket").value);
  let subtotal = totalItemDipilih() * hargaSatuan;

  let diskon = 0;
  if(paket === 3) diskon = subtotal * 0.05;
  if(paket === 6) diskon = subtotal * 0.10;

  let total = subtotal - diskon;

  const kode = document.getElementById("promoInput").value.toUpperCase();
  if(promoList[kode]){
    total -= total * promoList[kode];
  }

  document.getElementById("totalHarga").innerText =
    "Rp " + total.toLocaleString("id-ID");
}

function pesanSekarang(){
  const paket = parseInt(document.getElementById("paket").value);

  if(totalItemDipilih() !== paket){
    alert("Jumlah donat harus sesuai paket!");
    return;
  }

  let detail = "";
  for(let rasa in cart){
    if(cart[rasa] > 0){
      stokVarian[rasa].stok -= cart[rasa];
      detail += `${rasa} x${cart[rasa]}%0A`;
    }
  }

  const total = document.getElementById("totalHarga").innerText;

  const pesan = `Halo Admin DonatSur üç©%0A
Pesanan:%0A${detail}
${total}%0A
Terima kasih üôè`;

  window.open(`https://wa.me/${phoneNumber}?text=${pesan}`,"_blank");

  resetSemua();
}

function resetSemua(){
  generateMenu();
}

generateMenu();
</script>

</body>
</html>