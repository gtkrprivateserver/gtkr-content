<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Shop DonatSur - CHASTE DRAGON</title>
</head>

<body style="background:black;color:white;font-family:Poppins;padding:40px;line-height:1.6;">

<h1 style="color:gold;">üç© SHOP DONATSUR</h1>
<h2 style="color:gold;">CHASTE DRAGON SQUAD</h2>

<hr style="border:1px solid gold;margin:30px 0;">

<h3 style="color:gold;">Pilih Paket Box</h3>

<select id="paket" onchange="updateHarga()" style="padding:10px;">
  <option value="3">Box Isi 3 (Diskon 5%)</option>
  <option value="6">Box Isi 6 (Diskon 10%)</option>
</select>

<br><br>

<h3 style="color:gold;">Pilih Varian Rasa</h3>
<div id="varianContainer"></div>

<br>

<h3 style="color:gold;">Promo Code</h3>
<input type="text" id="promoInput" placeholder="Masukkan kode promo"
style="padding:8px;font-size:14px;">
<button onclick="updateHarga()" style="padding:8px;">Gunakan</button>

<br><br>

<h3>Total Harga:</h3>
<h2 id="totalHarga" style="color:gold;">Rp 0</h2>

<button onclick="pesanSekarang()" 
style="padding:15px 30px;background:gold;color:black;font-weight:bold;border:none;cursor:pointer;font-size:16px;">
Pesan Sekarang
</button>

<hr style="border:1px solid gold;margin:40px 0;">

<script>
const hargaSatuan = 8000;
const phoneNumber = "628XXXXXXXXXX"; // GANTI NOMOR ADMIN

// STOK VARIAN
let stokVarian = {
"Coklat": 10,
"Regal Matcha": 8,
"Tiramisu Biscoff": 5,
"Keju": 12,
"Custard Milk": 6,
"Sugar Dust": 15,
"Buttery Glazed": 7,
"Triple Choco": 4,
"Double Choco": 9
};

// PROMO CODE
const promoList = {
"DRAGON5": 0.05,
"DONAT10": 0.10
};

function generateVarianInput(jumlah){
  const container = document.getElementById("varianContainer");
  container.innerHTML = "";

  for(let i=1;i<=jumlah;i++){
    const select = document.createElement("select");
    select.id = "rasa"+i;
    select.style = "padding:8px;margin:5px;";

    for(let rasa in stokVarian){
      const option = document.createElement("option");
      option.value = rasa;
      option.text = `${rasa} (Stok: ${stokVarian[rasa]})`;
      if(stokVarian[rasa] <= 0){
        option.disabled = true;
      }
      select.appendChild(option);
    }

    container.appendChild(select);
  }
}

function updateHarga(){
  const paket = parseInt(document.getElementById("paket").value);
  generateVarianInput(paket);

  let subtotal = paket * hargaSatuan;
  let diskonPaket = 0;

  if(paket === 3) diskonPaket = subtotal * 0.05;
  if(paket === 6) diskonPaket = subtotal * 0.10;

  let total = subtotal - diskonPaket;

  // Promo Code
  const kode = document.getElementById("promoInput").value.toUpperCase();
  if(promoList[kode]){
    total -= total * promoList[kode];
  }

  document.getElementById("totalHarga").innerText =
    "Rp " + total.toLocaleString("id-ID");
}

function pesanSekarang(){
  const paket = parseInt(document.getElementById("paket").value);
  let rasaDipilih = "";
  let pilihan = [];

  for(let i=1;i<=paket;i++){
    const rasa = document.getElementById("rasa"+i).value;

    if(stokVarian[rasa] <= 0){
      alert("Stok " + rasa + " habis!");
      return;
    }

    pilihan.push(rasa);
    rasaDipilih += "Donat " + i + ": " + rasa + "%0A";
  }

  // Kurangi stok
  pilihan.forEach(rasa=>{
    stokVarian[rasa] -= 1;
  });

  updateHarga();

  let subtotal = paket * hargaSatuan;
  let diskonPaket = 0;

  if(paket === 3) diskonPaket = subtotal * 0.05;
  if(paket === 6) diskonPaket = subtotal * 0.10;

  let total = subtotal - diskonPaket;

  const kode = document.getElementById("promoInput").value.toUpperCase();
  if(promoList[kode]){
    total -= total * promoList[kode];
  }

  const pesan = `Halo Admin DonatSur üç©%0A
Saya ingin memesan:%0A
Box Isi ${paket}%0A
${rasaDipilih}
Total Bayar: Rp ${total.toLocaleString("id-ID")}%0A
Terima kasih üôè`;

  const url = `https://wa.me/${phoneNumber}?text=${pesan}`;
  window.open(url,"_blank");
}

updateHarga();
</script>

</body>
</html>